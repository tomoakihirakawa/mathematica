(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     75295,       1683]
NotebookOptionsPosition[     71604,       1625]
NotebookOutlinePosition[     71959,       1640]
CellTagsIndexPosition[     71916,       1637]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "\:53cd\:6642\:8a08\:307e\:308f\:308a\:304c\:6b63\:304b\:8ca0\:304b", 
    "\:ff0c", "\:4eba\:306b\:3088\:3063\:3066\:3053\:3068\:306a\:308b", 
    "\:ff0e", "\[IndentingNewLine]", 
    "\:53cd\:6642\:8a08\:56de\:308a\:304c\:6b63\:306e\:3053\:3068\:304c\:591a\
\:3044\:3088\:3046\:306a\:306e\:3067", "\:ff0c", 
    "\:3053\:3053\:3067\:3082\:305d\:306e\:3088\:3046\:306b\:6c7a\:3081\:308b\
"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.834698184450801*^9, 3.834698264103046*^9}},
 CellLabel->
  "(Local) In[1]:=",ExpressionUUID->"2b31d735-e29d-444a-bcfd-3faee6e2a949"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", "\:56de\:8ee2\:306b\:3064\:3044\:3066", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Rx", "[", "t_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"Cos", "[", "t", "]"}], ",", 
        RowBox[{"Sin", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "t", "]"}]}], ",", 
        RowBox[{"Cos", "[", "t", "]"}]}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ry", "[", "t_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "t", "]"}], ",", "0", ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "t", "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", "t", "]"}], ",", "0", ",", 
        RowBox[{"Cos", "[", "t", "]"}]}], "}"}]}], "}"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rz", "[", "t_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cos", "[", "t", "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"Sin", "[", "t", "]"}]}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sin", "[", "t", "]"}], ",", 
        RowBox[{"Cos", "[", "t", "]"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}]}], "*)"}]], "Input",\

 CellChangeTimes->{{3.834697363252921*^9, 3.834697454095598*^9}, {
   3.834697563574074*^9, 3.834697602656399*^9}, {3.834697689592119*^9, 
   3.83469769114358*^9}, 3.834698182598613*^9, {3.834698265919518*^9, 
   3.83469826621669*^9}, {3.834701363268299*^9, 3.8347013651647663`*^9}, {
   3.8463629829673357`*^9, 3.846362985283518*^9}},
 CellLabel->
  "(Local) In[2]:=",ExpressionUUID->"7d1664e3-978f-41ab-a8cf-f1b98e9e35df"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", 
   RowBox[{"z", "\[Rule]", 
    RowBox[{"x", "\[Rule]", "z\:30aa\:30a4\:30e9\:30fc\:89d2"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"Rz", "[", "t3", "]"}], ",", 
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"Rx", "[", "t2", "]"}], ",", 
        RowBox[{"Rz", "[", "t1", "]"}]}], "]"}]}], "]"}], "//", 
    "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"\:30e8\:30fc", "\[Rule]", 
     RowBox[{"\:30d4\:30c3\:30c1", "\[Rule]", "\:30ed\:30fc\:30eb\:89d2"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"Rx", "[", "t3", "]"}], ",", 
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"Ry", "[", "t2", "]"}], ",", 
        RowBox[{"Rz", "[", "t1", "]"}]}], "]"}]}], "]"}], "//", 
    "MatrixForm"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.834697954302494*^9, 3.8346979757835093`*^9}, {
  3.834698116366604*^9, 3.834698178782022*^9}, {3.834698464967863*^9, 
  3.834698477180888*^9}, {3.834699306595455*^9, 3.8346993100429773`*^9}, {
  3.834699375835692*^9, 3.834699380722323*^9}, {3.834699572074051*^9, 
  3.834699581825852*^9}},
 CellLabel->
  "(Local) In[3]:=",ExpressionUUID->"4a6f2f88-03d3-4b90-89b0-e6501177e11e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", "\:30aa\:30a4\:30e9\:30fc\:89d2", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"Rz", "[", "\[Gamma]", "]"}], ",", 
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"Rx", "[", "\[Beta]", "]"}], ",", 
        RowBox[{"Rz", "[", "\[Alpha]", "]"}]}], "]"}]}], "]"}], "//", 
    "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
   "(*", "\:30e8\:30fc\:30d4\:30c3\:30c1\:30ed\:30fc\:30eb\:89d2", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"Rx", "[", "\[Phi]", "]"}], ",", 
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"Ry", "[", "\[Theta]", "]"}], ",", 
        RowBox[{"Rz", "[", "\[Psi]", "]"}]}], "]"}]}], "]"}], "//", 
    "MatrixForm"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.834697954302494*^9, 3.8346979757835093`*^9}, {
  3.834698116366604*^9, 3.834698178782022*^9}},
 CellLabel->
  "(Local) In[4]:=",ExpressionUUID->"a3a97246-1bf3-4b96-9c04-34417016abea"],

Cell[CellGroupData[{

Cell["\:56de\:8ee2\:884c\:5217", "Subsection",
 CellChangeTimes->{{3.834722447337216*^9, 
  3.834722457229954*^9}},ExpressionUUID->"0b6f9ebe-534c-4608-b031-\
61b2437664cf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rs", "[", 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ind", ",", "s", ",", "a2", ",", "b2", ",", "c2", ",", "d2"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a2", "=", 
       RowBox[{"a", "*", "a"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"b2", "=", 
       RowBox[{"b", "*", "b"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"c2", "=", 
       RowBox[{"c", "*", "c"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d2", "=", 
       RowBox[{"d", "*", "d"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a2", "+", "b2", "-", "c2", "-", "d2"}], ",", 
          RowBox[{
           RowBox[{"2", "*", "b", "*", "c"}], "+", 
           RowBox[{"2", "*", "a", "*", "d"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], "*", "a", "*", "c"}], "+", 
           RowBox[{"2", "*", "b", "*", "d"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", "b", "*", "c"}], "-", 
           RowBox[{"2", "*", "a", "*", "d"}]}], ",", 
          RowBox[{"a2", "-", "b2", "+", "c2", "-", "d2"}], ",", 
          RowBox[{
           RowBox[{"2", "*", "a", "*", "b"}], "+", 
           RowBox[{"2", "*", "c", "*", "d"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", "a", "*", "c"}], "+", 
           RowBox[{"2", "*", "b", "*", "d"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], "*", "a", "*", "b"}], "+", 
           RowBox[{"2", "*", "c", "*", "d"}]}], ",", 
          RowBox[{"a2", "-", "b2", "-", "c2", "+", "d2"}]}], "}"}]}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Rv", "[", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "}"}], "]"}], "=", 
    RowBox[{"Inverse", "@", 
     RowBox[{"Rs", "[", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AxisAngleToQuaternion", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"axX_", ",", "axY_", ",", "axZ_"}], "}"}], ",", "angle_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "n", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Normalize", "[", 
        RowBox[{"{", 
         RowBox[{"axX", ",", "axY", ",", "axZ"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"-", "angle"}], "/", "2"}], "]"}], ",", 
         RowBox[{
          RowBox[{"n", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"-", "angle"}], "/", "2"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"n", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"-", "angle"}], "/", "2"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"n", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "*", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"-", "angle"}], "/", "2"}], "]"}]}]}], "}"}], "]"}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"IDEN", " ", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"S", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "}"}], "]"}], ":=", 
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", "*", "a"}], "+", 
         RowBox[{"b", "*", "b"}], "+", 
         RowBox[{"c", "*", "c"}], "+", 
         RowBox[{"d", "*", "d"}]}], ")"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"R", "[", 
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "}"}], "]"}], ":=", 
     RowBox[{"IDEN", "+", 
      RowBox[{
       RowBox[{"R0", "[", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "]"}], "*", 
       RowBox[{"S", "[", 
        RowBox[{"{", 
         RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "]"}]}]}]}], 
    ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rep", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "2"], "\[Rule]", "a2"}], ",", 
      RowBox[{
       SuperscriptBox["b", "2"], "\[Rule]", "b2"}], ",", 
      RowBox[{
       SuperscriptBox["d", "2"], "\[Rule]", "d2"}], ",", 
      RowBox[{
       SuperscriptBox["c", "2"], "\[Rule]", "c2"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       SuperscriptBox["a", "3"], "\[Rule]", "a3"}], ",", 
      RowBox[{
       SuperscriptBox["b", "3"], "\[Rule]", "b3"}], ",", 
      RowBox[{
       SuperscriptBox["d", "3"], "\[Rule]", "d3"}], ",", 
      RowBox[{
       SuperscriptBox["c", "3"], "\[Rule]", "c2"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
        "a2", " ", "+", " ", "b2", " ", "+", " ", "c2", " ", "+", " ", "d2"}],
         ")"}], "\[Rule]", "a2b2c2d2"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"u0", "^", "2"}], "\[Rule]", "u02"}], ",", 
      RowBox[{
       RowBox[{"u1", "^", "2"}], "\[Rule]", "u12"}], ",", 
      RowBox[{
       RowBox[{"u2", "^", "2"}], "\[Rule]", "u22"}], ",", 
      RowBox[{
       RowBox[{"u3", "^", "2"}], "\[Rule]", "u32"}], ",", 
      RowBox[{
       RowBox[{"u4", "^", "2"}], "\[Rule]", "u42"}], ",", 
      RowBox[{
       RowBox[{"u5", "^", "2"}], "\[Rule]", "u52"}], ",", 
      RowBox[{
       RowBox[{
        SuperscriptBox["gx0", "2"], "+", 
        SuperscriptBox["gy0", "2"], "+", 
        SuperscriptBox["gz0", "2"], "+", 
        SuperscriptBox["mx0", "2"], "+", 
        SuperscriptBox["my0", "2"], "+", 
        SuperscriptBox["mz0", "2"]}], "\[Rule]", "normGM2"}], ",", 
      RowBox[{"Power", "\[Rule]", "pow"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"R", "[", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "}"}], "]"}], ":=", 
    RowBox[{"Rs", "[", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<\:7a7a\:9593\:3092\:56de\:8ee2\:3055\:305b\:308b\:56de\:8ee2\:884c\
\:5217\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"CForm", "[", 
   RowBox[{
    RowBox[{"Rs", "[", 
     RowBox[{"{", 
      RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "]"}], "/.", 
    "rep"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  "\"\<\:7a7a\:9593\:3092\:56fa\:5b9a\:3057\:30d9\:30af\:30c8\:30eb\:3092\
\:56de\:8ee2\:3055\:305b\:308b\:56de\:8ee2\:884c\:5217\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"CForm", "[", 
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"Rs", "[", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "]"}], "/.", 
     "rep"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"N", "@", 
   RowBox[{"R", "[", 
    RowBox[{"Normalize", "@", 
     RowBox[{"{", 
      RowBox[{"4", ",", "1", ",", "2", ",", "3"}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Tmag", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Tmag00", ",", "Tmag01", ",", "Tmag02"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Tmag10", ",", "Tmag11", ",", "Tmag12"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Tmag20", ",", "Tmag21", ",", "Tmag22"}], "}"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RR", "[", 
   RowBox[{"{", 
    RowBox[{"a_", ",", "b_", ",", "c_", ",", "d_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"zeros", ",", "r"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"zeros", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0", ",", "2", ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "0", ",", "2", ",", "1"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"Rs", "[", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c", ",", "d"}], "}"}], "]"}]}], ";", 
     RowBox[{
     "(*", "\:30d9\:30af\:30c8\:30eb\:3092\:56de\:8ee2\:3059\:308b\:884c\:5217\
", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Join", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"r", ",", "zeros", ",", "2"}], "]"}], ",", 
       RowBox[{"Join", "[", 
        RowBox[{"zeros", ",", 
         RowBox[{"Dot", "[", 
          RowBox[{"r", ",", "Tmag"}], "]"}], ",", "2"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQ7VCzQlB90hvHlg8bwfSyuvZnvNPfODbthNDTXrF+
sVrxxvFdfPpXEC0XVmkfDaTTez87gehts2eGgWj3CLUIEK0wdUsSiC7I2JoF
ol2+TcwH0Y1TcypA9IWu620g+v9G73YQXVRfMwNE/1U4AKbFVsxeAaLPpNSt
BNE2B55sAtFGG+u2geg97Y1HwPpmnjsLos/reeyNBdLO1jyHQPSKHUs94oE0
46FjYFprR+zCHCDNlF64GETfS7V1ug2ktyYsANPSa6XD7gLpmKlcUSD6YNH/
BBDdIP0yGUQnpe5tDFr1xjEn37EJRAMAOlqkMQ==
  "],
 CellLabel->
  "(Local) In[5]:=",ExpressionUUID->"ee485b31-8882-4c18-bb3c-122587fae2ba"],

Cell[CellGroupData[{

Cell[BoxData["\<\"\:7a7a\:9593\:3092\:56de\:8ee2\:3055\:305b\:308b\:56de\:8ee2\
\:884c\:5217\"\>"], "Print",
 CellChangeTimes->{{3.846364234745681*^9, 3.84636424955239*^9}, 
   3.846364323737067*^9, {3.846364359022277*^9, 3.846364361552866*^9}, 
   3.846364496883218*^9, {3.846364597372073*^9, 3.846364599670495*^9}, {
   3.8463647750130777`*^9, 3.8463647834012613`*^9}, 3.8463648357450247`*^9, 
   3.84636487416335*^9, 3.846365930980015*^9, 3.846366882990725*^9, 
   3.846366916245913*^9, 3.8463687087070513`*^9, {3.846368760666772*^9, 
   3.846368785835112*^9}, 3.8463688678321667`*^9, 3.846368922801752*^9, 
   3.846368996469965*^9, 3.846371225648541*^9, 3.846371917924363*^9, 
   3.8463721599973707`*^9, 3.846372249716868*^9, 3.84637249507244*^9, 
   3.846392843305215*^9, 3.846398365288727*^9, {3.846399247554105*^9, 
   3.8463992631859627`*^9}, 3.846444831422161*^9, 3.846444905531535*^9, 
   3.846453715448793*^9, 3.846453802367288*^9, 3.846453857765176*^9, 
   3.846454230761887*^9, 3.8466244929693203`*^9, 3.846624687080779*^9, 
   3.846625816727294*^9, {3.8466267082087793`*^9, 3.84662672805021*^9}, 
   3.846628405522203*^9, 3.8466288792478724`*^9, 3.8466301772251*^9, 
   3.846632186821354*^9, 3.846705223557616*^9, 3.847394262035726*^9, 
   3.847395184255549*^9, 3.84739529323765*^9, 3.847395360402412*^9, {
   3.847395408685751*^9, 3.847395428930902*^9}, 3.8473967148942547`*^9, {
   3.847396764339972*^9, 3.847396789286211*^9}, 3.84740291569596*^9, 
   3.849394487413014*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1a(Local) \
In[5]:=",ExpressionUUID->"3ac7890e-e77c-4c14-a3b3-6e907f2a3d53"],

Cell[BoxData[
 InterpretationBox["\<\"List(List(a2 + b2 - c2 - d2,2*b*c + 2*a*d,-2*a*c + \
2*b*d),List(2*b*c - 2*a*d,a2 - b2 + c2 - d2,2*a*b + 2*c*d),List(2*a*c + \
2*b*d,-2*a*b + 2*c*d,a2 - b2 - c2 + d2))\"\>",
  CForm[{{$CellContext`a2 + $CellContext`b2 - $CellContext`c2 - \
$CellContext`d2, 2 $CellContext`b $CellContext`c + 
     2 $CellContext`a $CellContext`d, (-2) $CellContext`a $CellContext`c + 
     2 $CellContext`b $CellContext`d}, {
    2 $CellContext`b $CellContext`c - 
     2 $CellContext`a $CellContext`d, $CellContext`a2 - $CellContext`b2 + \
$CellContext`c2 - $CellContext`d2, 2 $CellContext`a $CellContext`b + 
     2 $CellContext`c $CellContext`d}, {
    2 $CellContext`a $CellContext`c + 
     2 $CellContext`b $CellContext`d, (-2) $CellContext`a $CellContext`b + 
     2 $CellContext`c $CellContext`d, $CellContext`a2 - $CellContext`b2 - \
$CellContext`c2 + $CellContext`d2}}],
  AutoDelete->True,
  Editable->True]], "Print",
 CellChangeTimes->{{3.846364234745681*^9, 3.84636424955239*^9}, 
   3.846364323737067*^9, {3.846364359022277*^9, 3.846364361552866*^9}, 
   3.846364496883218*^9, {3.846364597372073*^9, 3.846364599670495*^9}, {
   3.8463647750130777`*^9, 3.8463647834012613`*^9}, 3.8463648357450247`*^9, 
   3.84636487416335*^9, 3.846365930980015*^9, 3.846366882990725*^9, 
   3.846366916245913*^9, 3.8463687087070513`*^9, {3.846368760666772*^9, 
   3.846368785835112*^9}, 3.8463688678321667`*^9, 3.846368922801752*^9, 
   3.846368996469965*^9, 3.846371225648541*^9, 3.846371917924363*^9, 
   3.8463721599973707`*^9, 3.846372249716868*^9, 3.84637249507244*^9, 
   3.846392843305215*^9, 3.846398365288727*^9, {3.846399247554105*^9, 
   3.8463992631859627`*^9}, 3.846444831422161*^9, 3.846444905531535*^9, 
   3.846453715448793*^9, 3.846453802367288*^9, 3.846453857765176*^9, 
   3.846454230761887*^9, 3.8466244929693203`*^9, 3.846624687080779*^9, 
   3.846625816727294*^9, {3.8466267082087793`*^9, 3.84662672805021*^9}, 
   3.846628405522203*^9, 3.8466288792478724`*^9, 3.8466301772251*^9, 
   3.846632186821354*^9, 3.846705223557616*^9, 3.847394262035726*^9, 
   3.847395184255549*^9, 3.84739529323765*^9, 3.847395360402412*^9, {
   3.847395408685751*^9, 3.847395428930902*^9}, 3.8473967148942547`*^9, {
   3.847396764339972*^9, 3.847396789286211*^9}, 3.84740291569596*^9, 
   3.8493944874172*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1a(Local) \
In[5]:=",ExpressionUUID->"2f1fd9c5-6504-4263-87fc-10303c2b2067"],

Cell[BoxData["\<\"\:7a7a\:9593\:3092\:56fa\:5b9a\:3057\:30d9\:30af\:30c8\:30eb\
\:3092\:56de\:8ee2\:3055\:305b\:308b\:56de\:8ee2\:884c\:5217\"\>"], "Print",
 CellChangeTimes->{{3.846364234745681*^9, 3.84636424955239*^9}, 
   3.846364323737067*^9, {3.846364359022277*^9, 3.846364361552866*^9}, 
   3.846364496883218*^9, {3.846364597372073*^9, 3.846364599670495*^9}, {
   3.8463647750130777`*^9, 3.8463647834012613`*^9}, 3.8463648357450247`*^9, 
   3.84636487416335*^9, 3.846365930980015*^9, 3.846366882990725*^9, 
   3.846366916245913*^9, 3.8463687087070513`*^9, {3.846368760666772*^9, 
   3.846368785835112*^9}, 3.8463688678321667`*^9, 3.846368922801752*^9, 
   3.846368996469965*^9, 3.846371225648541*^9, 3.846371917924363*^9, 
   3.8463721599973707`*^9, 3.846372249716868*^9, 3.84637249507244*^9, 
   3.846392843305215*^9, 3.846398365288727*^9, {3.846399247554105*^9, 
   3.8463992631859627`*^9}, 3.846444831422161*^9, 3.846444905531535*^9, 
   3.846453715448793*^9, 3.846453802367288*^9, 3.846453857765176*^9, 
   3.846454230761887*^9, 3.8466244929693203`*^9, 3.846624687080779*^9, 
   3.846625816727294*^9, {3.8466267082087793`*^9, 3.84662672805021*^9}, 
   3.846628405522203*^9, 3.8466288792478724`*^9, 3.8466301772251*^9, 
   3.846632186821354*^9, 3.846705223557616*^9, 3.847394262035726*^9, 
   3.847395184255549*^9, 3.84739529323765*^9, 3.847395360402412*^9, {
   3.847395408685751*^9, 3.847395428930902*^9}, 3.8473967148942547`*^9, {
   3.847396764339972*^9, 3.847396789286211*^9}, 3.84740291569596*^9, 
   3.849394487421789*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1a(Local) \
In[5]:=",ExpressionUUID->"c8d0496a-781a-4298-a5c2-c41e616ccfa5"],

Cell[BoxData[
 InterpretationBox["\<\"List(List(a2 + b2 - c2 - d2,2*b*c - 2*a*d,2*a*c + \
2*b*d),List(2*b*c + 2*a*d,a2 - b2 + c2 - d2,-2*a*b + 2*c*d),List(-2*a*c + \
2*b*d,2*a*b + 2*c*d,a2 - b2 - c2 + d2))\"\>",
  CForm[{{$CellContext`a2 + $CellContext`b2 - $CellContext`c2 - \
$CellContext`d2, 2 $CellContext`b $CellContext`c - 
     2 $CellContext`a $CellContext`d, 2 $CellContext`a $CellContext`c + 
     2 $CellContext`b $CellContext`d}, {
    2 $CellContext`b $CellContext`c + 
     2 $CellContext`a $CellContext`d, $CellContext`a2 - $CellContext`b2 + \
$CellContext`c2 - $CellContext`d2, (-2) $CellContext`a $CellContext`b + 
     2 $CellContext`c $CellContext`d}, {(-2) $CellContext`a $CellContext`c + 
     2 $CellContext`b $CellContext`d, 2 $CellContext`a $CellContext`b + 
     2 $CellContext`c $CellContext`d, $CellContext`a2 - $CellContext`b2 - \
$CellContext`c2 + $CellContext`d2}}],
  AutoDelete->True,
  Editable->True]], "Print",
 CellChangeTimes->{{3.846364234745681*^9, 3.84636424955239*^9}, 
   3.846364323737067*^9, {3.846364359022277*^9, 3.846364361552866*^9}, 
   3.846364496883218*^9, {3.846364597372073*^9, 3.846364599670495*^9}, {
   3.8463647750130777`*^9, 3.8463647834012613`*^9}, 3.8463648357450247`*^9, 
   3.84636487416335*^9, 3.846365930980015*^9, 3.846366882990725*^9, 
   3.846366916245913*^9, 3.8463687087070513`*^9, {3.846368760666772*^9, 
   3.846368785835112*^9}, 3.8463688678321667`*^9, 3.846368922801752*^9, 
   3.846368996469965*^9, 3.846371225648541*^9, 3.846371917924363*^9, 
   3.8463721599973707`*^9, 3.846372249716868*^9, 3.84637249507244*^9, 
   3.846392843305215*^9, 3.846398365288727*^9, {3.846399247554105*^9, 
   3.8463992631859627`*^9}, 3.846444831422161*^9, 3.846444905531535*^9, 
   3.846453715448793*^9, 3.846453802367288*^9, 3.846453857765176*^9, 
   3.846454230761887*^9, 3.8466244929693203`*^9, 3.846624687080779*^9, 
   3.846625816727294*^9, {3.8466267082087793`*^9, 3.84662672805021*^9}, 
   3.846628405522203*^9, 3.8466288792478724`*^9, 3.8466301772251*^9, 
   3.846632186821354*^9, 3.846705223557616*^9, 3.847394262035726*^9, 
   3.847395184255549*^9, 3.84739529323765*^9, 3.847395360402412*^9, {
   3.847395408685751*^9, 3.847395428930902*^9}, 3.8473967148942547`*^9, {
   3.847396764339972*^9, 3.847396789286211*^9}, 3.84740291569596*^9, 
   3.849394487422605*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1a(Local) \
In[5]:=",ExpressionUUID->"f8728432-5a65-489b-8a21-012f2402e896"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.13333333333333333`", ",", "0.9333333333333333`", ",", 
     RowBox[{"-", "0.3333333333333333`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.6666666666666666`"}], ",", "0.3333333333333333`", ",", 
     "0.6666666666666666`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.7333333333333333`", ",", "0.13333333333333333`", ",", 
     "0.6666666666666666`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.83472243672709*^9, 3.834722506753418*^9, 3.834722616647839*^9, 
   3.83472390605599*^9, 3.834723953088397*^9, 3.837291474653227*^9, 
   3.8372947040221252`*^9, 3.8372948354588737`*^9, 3.837295149679432*^9, 
   3.837295373223041*^9, 3.837295754185071*^9, 3.8372958938667*^9, 
   3.837296139320345*^9, {3.837296219975369*^9, 3.837296228604842*^9}, 
   3.837296309998904*^9, 3.8372967765824633`*^9, 3.8372971149026203`*^9, 
   3.837298101455673*^9, 3.837298149674844*^9, 3.837311188977585*^9, 
   3.837382599833663*^9, 3.846297517696422*^9, 3.8463627191677094`*^9, {
   3.846363047566354*^9, 3.8463630673862467`*^9}, 3.846363478192128*^9, 
   3.846363574208213*^9, {3.846364102522498*^9, 3.846364107367326*^9}, {
   3.84636415299207*^9, 3.8463641789085703`*^9}, {3.846364223996088*^9, 
   3.8463642495581427`*^9}, 3.846364323742845*^9, {3.846364359028084*^9, 
   3.846364361558834*^9}, 3.84636449688957*^9, {3.846364597379273*^9, 
   3.846364599676311*^9}, {3.8463647750081673`*^9, 3.84636478340714*^9}, 
   3.846364835751216*^9, 3.8463648741696*^9, 3.84636593098599*^9, 
   3.8463668829965982`*^9, 3.846366916251957*^9, 3.846368708713893*^9, {
   3.846368760673788*^9, 3.846368785840994*^9}, 3.846368867837736*^9, 
   3.846368922808049*^9, 3.846368996475897*^9, 3.8463712256560297`*^9, 
   3.846371917930605*^9, 3.846372160003738*^9, 3.8463722497229013`*^9, 
   3.8463724950798283`*^9, 3.846392843312483*^9, 3.846398365295105*^9, {
   3.846399247559988*^9, 3.8463992631921663`*^9}, 3.846444831428465*^9, 
   3.846444905537417*^9, 3.846453715454645*^9, 3.846453802373006*^9, 
   3.8464538577710333`*^9, 3.846454230767662*^9, 3.846624492975383*^9, 
   3.846624687086994*^9, 3.84662581673377*^9, {3.84662670821485*^9, 
   3.846626728056162*^9}, 3.846628405529584*^9, 3.846628879255932*^9, 
   3.8466301772322063`*^9, 3.846632186828231*^9, 3.846705223562132*^9, 
   3.8473942620401917`*^9, 3.847395184260049*^9, 3.8473952932448177`*^9, 
   3.847395360407053*^9, {3.84739540869016*^9, 3.847395428936255*^9}, 
   3.847396714907421*^9, {3.8473967643455973`*^9, 3.847396789292654*^9}, 
   3.847402915700835*^9, 3.849394487423504*^9},
 CellLabel->
  "(Local) Out[15]=",ExpressionUUID->"eb45f529-ec91-43c5-89e6-84fe19259ec1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
  "(*", "\:78c1\:5834\:30bb\:30f3\:30b5\:30fc\:306e\:30ad\:30e3\:30ea\:30d6\
\:30ec\:30fc\:30b7\:30e7\:30f3", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"InitM", "=", " ", 
    RowBox[{"{", 
     RowBox[{"InitMx", ",", "InitMy", ",", "InitMz"}], "}"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"imported", " ", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"NotebookDirectory", "[", "]"}], ",", 
         "\"\</dataAHRS.json\>\""}], "}"}], "]"}], "]"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"imported", " ", "=", 
     RowBox[{"Import", "[", 
      RowBox[{
      "FileNameJoin", "[", 
       "\"\</Users/tomoaki/Dropbox/markdown/python_shared/example_AHRS/\
dataAHRS.json\>\"", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rowGyros", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\"\<mag\>\"", "/.", "#5"}], ")"}], "&"}], "@@@", 
      "imported"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"minmaxx", "=", 
    RowBox[{"MinMax", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "rowGyros", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"minmaxy", "=", 
    RowBox[{"MinMax", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "rowGyros", "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"minmaxz", "=", 
    RowBox[{"MinMax", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", "rowGyros", "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"bx", "=", 
    RowBox[{"Mean", "@", 
     RowBox[{"MinMax", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", "rowGyros", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"by", "=", 
    RowBox[{"Mean", "@", 
     RowBox[{"MinMax", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", "rowGyros", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"bz", "=", 
    RowBox[{"Mean", "@", 
     RowBox[{"MinMax", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", "rowGyros", "]"}], "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xyz0", "=", 
     RowBox[{"{", 
      RowBox[{"3.228119", ",", "1.428089", ",", 
       RowBox[{"-", "0.1646344"}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"zxy0", "=", 
     RowBox[{"{", 
      RowBox[{"1.709656", ",", 
       RowBox[{"-", "4.774952"}], ",", "0.3312323"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"yzx0", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "3.148223"}], ",", 
       RowBox[{"-", "1.231832"}], ",", "2.327193"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"xyz1", "=", 
     RowBox[{"{", 
      RowBox[{"2.509454", ",", 
       RowBox[{"-", "0.3869823"}], ",", 
       RowBox[{"-", "4.416062"}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"zxy1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.7328072"}], ",", 
       RowBox[{"-", "1.283755"}], ",", "0.2551079"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"yzx1", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "3.31675"}], ",", 
       RowBox[{"-", "0.01326677"}], ",", 
       RowBox[{"-", "0.3701058"}]}], "}"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"{", 
      RowBox[{
      "xyz0", ",", "zxy0", ",", "yzx0", ",", "xyz1", ",", "zxy1", ",", 
       "yzx1"}], "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Mx0", ",", "My0", ",", "Mz0"}], "}"}], "=", "xyz0"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Mx1", ",", "My1", ",", "Mz1"}], "}"}], "=", "zxy0"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Mx2", ",", "My2", ",", "Mz2"}], "}"}], "=", "yzx0"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InitM", "=", 
     RowBox[{"{", 
      RowBox[{"Mx0", ",", "My0", ",", "Mz0"}], "}"}]}], ";", " ", 
    RowBox[{"{", 
     RowBox[{"InitMx", ",", "InitMy", ",", "InitMz"}], "}"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"InvRs0", "=", 
    RowBox[{"Inverse", "@", 
     RowBox[{"Rs", "[", 
      RowBox[{"AxisAngleToQuaternion", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{
         RowBox[{"0", "/", "180"}], "*", "Pi"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"InvRs1", "=", 
    RowBox[{"Inverse", "@", 
     RowBox[{"Rs", "[", 
      RowBox[{"AxisAngleToQuaternion", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "120"}], "/", "180"}], "*", "Pi"}]}], "]"}], "]"}]}]}],
    "\[IndentingNewLine]", 
   RowBox[{"InvRs2", "=", 
    RowBox[{"Inverse", "@", 
     RowBox[{"Rs", "[", 
      RowBox[{"AxisAngleToQuaternion", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "240"}], "/", "180"}], "*", "Pi"}]}], "]"}], "]"}]}]}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Mb", "[", 
     RowBox[{"{", 
      RowBox[{"Mx_", ",", "My_", ",", "Mz_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Mx", "-", "bx"}], ",", 
        RowBox[{"My", "-", "by"}], ",", 
        RowBox[{"Mz", "-", "bz"}], ",", "0", ",", "0", ",", "0", ",", "0", 
        ",", "0", ",", "0"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        RowBox[{"Mx", "-", "bx"}], ",", 
        RowBox[{"My", "-", "by"}], ",", 
        RowBox[{"Mz", "-", "bz"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        RowBox[{"Mx", "-", "bx"}], ",", 
        RowBox[{"My", "-", "by"}], ",", 
        RowBox[{"Mz", "-", "bz"}]}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"MatrxMb", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Mb", "[", 
       RowBox[{"{", 
        RowBox[{"Mx0", ",", "My0", ",", "Mz0"}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Mb", "[", 
       RowBox[{"{", 
        RowBox[{"Mx1", ",", "My1", ",", "Mz1"}], "}"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Mb", "[", 
       RowBox[{"{", 
        RowBox[{"Mx2", ",", "My2", ",", "Mz2"}], "}"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"RsInitM", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Dot", "[", 
       RowBox[{"InvRs0", ",", "InitM"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Dot", "[", 
       RowBox[{"InvRs1", ",", "InitM"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Dot", "[", 
       RowBox[{"InvRs2", ",", "InitM"}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"MT", "=", 
    RowBox[{"FullSimplify", "@", 
     RowBox[{"Dot", "[", 
      RowBox[{
       RowBox[{"Inverse", "[", "MatrxMb", "]"}], ",", "RsInitM"}], "]"}], 
     RowBox[{"(*", "modificationMatrix", "*)"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.846628161834729*^9, 3.84662816796738*^9}, {
   3.846628208800325*^9, 3.846628283017416*^9}, {3.846628429225052*^9, 
   3.846628711625819*^9}, {3.846628772648019*^9, 3.846628930087448*^9}, {
   3.8466294215680323`*^9, 3.8466295690351267`*^9}, {3.8466318374183273`*^9, 
   3.8466318651826363`*^9}, 3.846632172221843*^9, {3.8467063802540293`*^9, 
   3.846706413655491*^9}, {3.8467073638681173`*^9, 3.846707469147057*^9}, {
   3.846707622868393*^9, 3.84670766333526*^9}, {3.846708114152729*^9, 
   3.8467082195768213`*^9}, {3.846708298149637*^9, 3.846708299217301*^9}, {
   3.8467083787788267`*^9, 3.8467084625466433`*^9}, {3.847395160343953*^9, 
   3.84739518308689*^9}, {3.847395326587228*^9, 3.847395351842634*^9}, {
   3.847395391174999*^9, 3.847395406699501*^9}, {3.847395810223777*^9, 
   3.8473958167445173`*^9}, 3.8493944847507877`*^9},
 CellLabel->
  "(Local) In[18]:=",ExpressionUUID->"32f93084-6793-4ff0-a65e-e313500183e6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2.347717`"}], ",", "0.4785156`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.846706415565074*^9, {3.846707631149786*^9, 3.8467076644597*^9}, 
   3.846708220235462*^9, 3.8467082996590223`*^9, {3.846708401340831*^9, 
   3.8467084632647333`*^9}, 3.847394262222459*^9, 3.847395184315213*^9, 
   3.847395293307969*^9, 3.847395360454537*^9, {3.847395408736745*^9, 
   3.847395428962832*^9}, 3.8473967149670553`*^9, {3.84739676437037*^9, 
   3.8473967893278913`*^9}, 3.847402915746982*^9, 3.849394487532675*^9},
 CellLabel->
  "(Local) Out[20]=",ExpressionUUID->"c43fda8d-5c72-43f1-a7a9-11b7878fa012"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.6430054`"}], ",", "2.123413`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.846706415565074*^9, {3.846707631149786*^9, 3.8467076644597*^9}, 
   3.846708220235462*^9, 3.8467082996590223`*^9, {3.846708401340831*^9, 
   3.8467084632647333`*^9}, 3.847394262222459*^9, 3.847395184315213*^9, 
   3.847395293307969*^9, 3.847395360454537*^9, {3.847395408736745*^9, 
   3.847395428962832*^9}, 3.8473967149670553`*^9, {3.84739676437037*^9, 
   3.8473967893278913`*^9}, 3.847402915746982*^9, 3.8493944875346613`*^9},
 CellLabel->
  "(Local) Out[21]=",ExpressionUUID->"2f13862f-b395-40ad-9a6c-977faed1c4c1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.6280518`", ",", "3.304749`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.846706415565074*^9, {3.846707631149786*^9, 3.8467076644597*^9}, 
   3.846708220235462*^9, 3.8467082996590223`*^9, {3.846708401340831*^9, 
   3.8467084632647333`*^9}, 3.847394262222459*^9, 3.847395184315213*^9, 
   3.847395293307969*^9, 3.847395360454537*^9, {3.847395408736745*^9, 
   3.847395428962832*^9}, 3.8473967149670553`*^9, {3.84739676437037*^9, 
   3.8473967893278913`*^9}, 3.847402915746982*^9, 3.849394487536532*^9},
 CellLabel->
  "(Local) Out[22]=",ExpressionUUID->"01da4302-0eea-43c6-8725-089f2a4c8cbd"],

Cell[BoxData[
 RowBox[{"-", "0.9346007`"}]], "Output",
 CellChangeTimes->{
  3.846706415565074*^9, {3.846707631149786*^9, 3.8467076644597*^9}, 
   3.846708220235462*^9, 3.8467082996590223`*^9, {3.846708401340831*^9, 
   3.8467084632647333`*^9}, 3.847394262222459*^9, 3.847395184315213*^9, 
   3.847395293307969*^9, 3.847395360454537*^9, {3.847395408736745*^9, 
   3.847395428962832*^9}, 3.8473967149670553`*^9, {3.84739676437037*^9, 
   3.8473967893278913`*^9}, 3.847402915746982*^9, 3.849394487537879*^9},
 CellLabel->
  "(Local) Out[23]=",ExpressionUUID->"42c4d9a7-f5cb-4e8b-a658-2191439a47b2"],

Cell[BoxData["0.7402038000000002`"], "Output",
 CellChangeTimes->{
  3.846706415565074*^9, {3.846707631149786*^9, 3.8467076644597*^9}, 
   3.846708220235462*^9, 3.8467082996590223`*^9, {3.846708401340831*^9, 
   3.8467084632647333`*^9}, 3.847394262222459*^9, 3.847395184315213*^9, 
   3.847395293307969*^9, 3.847395360454537*^9, {3.847395408736745*^9, 
   3.847395428962832*^9}, 3.8473967149670553`*^9, {3.84739676437037*^9, 
   3.8473967893278913`*^9}, 3.847402915746982*^9, 3.849394487539302*^9},
 CellLabel->
  "(Local) Out[24]=",ExpressionUUID->"368b0947-b39e-4be4-bce9-0e292aa4edc6"],

Cell[BoxData["1.9664004000000002`"], "Output",
 CellChangeTimes->{
  3.846706415565074*^9, {3.846707631149786*^9, 3.8467076644597*^9}, 
   3.846708220235462*^9, 3.8467082996590223`*^9, {3.846708401340831*^9, 
   3.8467084632647333`*^9}, 3.847394262222459*^9, 3.847395184315213*^9, 
   3.847395293307969*^9, 3.847395360454537*^9, {3.847395408736745*^9, 
   3.847395428962832*^9}, 3.8473967149670553`*^9, {3.84739676437037*^9, 
   3.8473967893278913`*^9}, 3.847402915746982*^9, 3.849394487540715*^9},
 CellLabel->
  "(Local) Out[25]=",ExpressionUUID->"6ba28095-24b4-4b32-92a3-34e4f1590a9d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.228119`", ",", "1.428089`", ",", 
   RowBox[{"-", "0.1646344`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.846706415565074*^9, {3.846707631149786*^9, 3.8467076644597*^9}, 
   3.846708220235462*^9, 3.8467082996590223`*^9, {3.846708401340831*^9, 
   3.8467084632647333`*^9}, 3.847394262222459*^9, 3.847395184315213*^9, 
   3.847395293307969*^9, 3.847395360454537*^9, {3.847395408736745*^9, 
   3.847395428962832*^9}, 3.8473967149670553`*^9, {3.84739676437037*^9, 
   3.8473967893278913`*^9}, 3.847402915746982*^9, 3.849394487541977*^9},
 CellLabel->
  "(Local) Out[33]=",ExpressionUUID->"63e024fe-0efc-4ed7-a639-bc548f340d15"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.709656`", ",", 
   RowBox[{"-", "4.774952`"}], ",", "0.3312323`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.846706415565074*^9, {3.846707631149786*^9, 3.8467076644597*^9}, 
   3.846708220235462*^9, 3.8467082996590223`*^9, {3.846708401340831*^9, 
   3.8467084632647333`*^9}, 3.847394262222459*^9, 3.847395184315213*^9, 
   3.847395293307969*^9, 3.847395360454537*^9, {3.847395408736745*^9, 
   3.847395428962832*^9}, 3.8473967149670553`*^9, {3.84739676437037*^9, 
   3.8473967893278913`*^9}, 3.847402915746982*^9, 3.849394487543251*^9},
 CellLabel->
  "(Local) Out[34]=",ExpressionUUID->"36dcf3f1-20bc-4318-9de1-aee92c836cf1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "3.148223`"}], ",", 
   RowBox[{"-", "1.231832`"}], ",", "2.327193`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.846706415565074*^9, {3.846707631149786*^9, 3.8467076644597*^9}, 
   3.846708220235462*^9, 3.8467082996590223`*^9, {3.846708401340831*^9, 
   3.8467084632647333`*^9}, 3.847394262222459*^9, 3.847395184315213*^9, 
   3.847395293307969*^9, 3.847395360454537*^9, {3.847395408736745*^9, 
   3.847395428962832*^9}, 3.8473967149670553`*^9, {3.84739676437037*^9, 
   3.8473967893278913`*^9}, 3.847402915746982*^9, 3.84939448754451*^9},
 CellLabel->
  "(Local) Out[35]=",ExpressionUUID->"5fcde627-422a-456a-8f57-f61172fbf2e9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"InitMx", ",", "InitMy", ",", "InitMz"}], "}"}]], "Output",
 CellChangeTimes->{
  3.846706415565074*^9, {3.846707631149786*^9, 3.8467076644597*^9}, 
   3.846708220235462*^9, 3.8467082996590223`*^9, {3.846708401340831*^9, 
   3.8467084632647333`*^9}, 3.847394262222459*^9, 3.847395184315213*^9, 
   3.847395293307969*^9, 3.847395360454537*^9, {3.847395408736745*^9, 
   3.847395428962832*^9}, 3.8473967149670553`*^9, {3.84739676437037*^9, 
   3.8473967893278913`*^9}, 3.847402915746982*^9, 3.8493944875457907`*^9},
 CellLabel->
  "(Local) Out[36]=",ExpressionUUID->"22034877-2bc1-4f64-9831-26b2681fabbd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.846706415565074*^9, {3.846707631149786*^9, 3.8467076644597*^9}, 
   3.846708220235462*^9, 3.8467082996590223`*^9, {3.846708401340831*^9, 
   3.8467084632647333`*^9}, 3.847394262222459*^9, 3.847395184315213*^9, 
   3.847395293307969*^9, 3.847395360454537*^9, {3.847395408736745*^9, 
   3.847395428962832*^9}, 3.8473967149670553`*^9, {3.84739676437037*^9, 
   3.8473967893278913`*^9}, 3.847402915746982*^9, 3.849394487547073*^9},
 CellLabel->
  "(Local) Out[37]=",ExpressionUUID->"f5a1bd6f-9c77-4247-98b2-fb52078f392c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.846706415565074*^9, {3.846707631149786*^9, 3.8467076644597*^9}, 
   3.846708220235462*^9, 3.8467082996590223`*^9, {3.846708401340831*^9, 
   3.8467084632647333`*^9}, 3.847394262222459*^9, 3.847395184315213*^9, 
   3.847395293307969*^9, 3.847395360454537*^9, {3.847395408736745*^9, 
   3.847395428962832*^9}, 3.8473967149670553`*^9, {3.84739676437037*^9, 
   3.8473967893278913`*^9}, 3.847402915746982*^9, 3.849394487548617*^9},
 CellLabel->
  "(Local) Out[38]=",ExpressionUUID->"9600eb8f-86a4-46b9-9f2b-80693c321ad0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.846706415565074*^9, {3.846707631149786*^9, 3.8467076644597*^9}, 
   3.846708220235462*^9, 3.8467082996590223`*^9, {3.846708401340831*^9, 
   3.8467084632647333`*^9}, 3.847394262222459*^9, 3.847395184315213*^9, 
   3.847395293307969*^9, 3.847395360454537*^9, {3.847395408736745*^9, 
   3.847395428962832*^9}, 3.8473967149670553`*^9, {3.84739676437037*^9, 
   3.8473967893278913`*^9}, 3.847402915746982*^9, 3.8493944875501223`*^9},
 CellLabel->
  "(Local) Out[39]=",ExpressionUUID->"68390b61-323e-413a-8c0a-43bf0a4de2ca"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"4.1627197`", ",", "0.6878851999999998`", ",", 
     RowBox[{"-", "2.1310348`"}], ",", "0", ",", "0", ",", "0", ",", "0", ",",
      "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "4.1627197`", ",", "0.6878851999999998`", 
     ",", 
     RowBox[{"-", "2.1310348`"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "4.1627197`", 
     ",", "0.6878851999999998`", ",", 
     RowBox[{"-", "2.1310348`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.6442567`", ",", 
     RowBox[{"-", "5.5151558000000005`"}], ",", 
     RowBox[{"-", "1.6351681000000002`"}], ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "2.6442567`", ",", 
     RowBox[{"-", "5.5151558000000005`"}], ",", 
     RowBox[{"-", "1.6351681000000002`"}], ",", "0", ",", "0", ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "2.6442567`", 
     ",", 
     RowBox[{"-", "5.5151558000000005`"}], ",", 
     RowBox[{"-", "1.6351681000000002`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.2136223000000004`"}], ",", 
     RowBox[{"-", "1.9720358000000002`"}], ",", "0.3607925999999997`", ",", 
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "2.2136223000000004`"}], ",", 
     RowBox[{"-", "1.9720358000000002`"}], ",", "0.3607925999999997`", ",", 
     "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "2.2136223000000004`"}], ",", 
     RowBox[{"-", "1.9720358000000002`"}], ",", "0.3607925999999997`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.846706415565074*^9, {3.846707631149786*^9, 3.8467076644597*^9}, 
   3.846708220235462*^9, 3.8467082996590223`*^9, {3.846708401340831*^9, 
   3.8467084632647333`*^9}, 3.847394262222459*^9, 3.847395184315213*^9, 
   3.847395293307969*^9, 3.847395360454537*^9, {3.847395408736745*^9, 
   3.847395428962832*^9}, 3.8473967149670553`*^9, {3.84739676437037*^9, 
   3.8473967893278913`*^9}, 3.847402915746982*^9, 3.849394487551651*^9},
 CellLabel->
  "(Local) Out[41]=",ExpressionUUID->"fc6e2735-733d-42ba-a7e0-ac7bddb78e8c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3.228119`", ",", "1.428089`", ",", 
   RowBox[{"-", "0.1646344`"}], ",", 
   RowBox[{"-", "0.1646344`"}], ",", "3.228119`", ",", "1.428089`", ",", 
   "1.428089`", ",", 
   RowBox[{"-", "0.1646344`"}], ",", "3.228119`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.846706415565074*^9, {3.846707631149786*^9, 3.8467076644597*^9}, 
   3.846708220235462*^9, 3.8467082996590223`*^9, {3.846708401340831*^9, 
   3.8467084632647333`*^9}, 3.847394262222459*^9, 3.847395184315213*^9, 
   3.847395293307969*^9, 3.847395360454537*^9, {3.847395408736745*^9, 
   3.847395428962832*^9}, 3.8473967149670553`*^9, {3.84739676437037*^9, 
   3.8473967893278913`*^9}, 3.847402915746982*^9, 3.849394487553179*^9},
 CellLabel->
  "(Local) Out[42]=",ExpressionUUID->"320509bf-59bc-4498-8a4b-2baeb59f3778"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "2.078896159675358`"}], ",", "0.6262943741422963`", ",", 
   RowBox[{"-", "5.373521993784059`"}], ",", "0.4310477150319294`", ",", 
   RowBox[{"-", "0.39208148119255143`"}], ",", "0.04529947934072423`", ",", 
   RowBox[{"-", "2.032016750172331`"}], ",", 
   RowBox[{"-", "0.07233458012035765`"}], ",", 
   RowBox[{"-", "3.9153934247274367`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.846706415565074*^9, {3.846707631149786*^9, 3.8467076644597*^9}, 
   3.846708220235462*^9, 3.8467082996590223`*^9, {3.846708401340831*^9, 
   3.8467084632647333`*^9}, 3.847394262222459*^9, 3.847395184315213*^9, 
   3.847395293307969*^9, 3.847395360454537*^9, {3.847395408736745*^9, 
   3.847395428962832*^9}, 3.8473967149670553`*^9, {3.84739676437037*^9, 
   3.8473967893278913`*^9}, 3.847402915746982*^9, 3.849394487695942*^9},
 CellLabel->
  "(Local) Out[43]=",ExpressionUUID->"48105135-7962-4e88-84a9-cfcf3798f5ba"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"magModified", "[", "mag_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Return", "@", 
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RsInitM", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"RsInitM", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"RsInitM", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RsInitM", "[", 
              RowBox[{"[", "4", "]"}], "]"}], ",", 
             RowBox[{"RsInitM", "[", 
              RowBox[{"[", "5", "]"}], "]"}], ",", 
             RowBox[{"RsInitM", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"RsInitM", "[", 
              RowBox[{"[", "7", "]"}], "]"}], ",", 
             RowBox[{"RsInitM", "[", 
              RowBox[{"[", "8", "]"}], "]"}], ",", 
             RowBox[{"RsInitM", "[", 
              RowBox[{"[", "9", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"mag", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "bx"}], ",", 
           RowBox[{
            RowBox[{"mag", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", "by"}], ",", 
           RowBox[{
            RowBox[{"mag", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "-", "bz"}]}], "}"}]}], "]"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Return", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "bx"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", "by"}], ",", 
         RowBox[{
          RowBox[{"mag", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "-", "bz"}]}], "}"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.846705247636532*^9, 3.846705385941883*^9}, 
   3.846705493662937*^9, 3.8467077106428967`*^9, {3.846707960626071*^9, 
   3.84670796730727*^9}, {3.8467080662086143`*^9, 3.8467080698931847`*^9}, {
   3.846708478414604*^9, 3.84670848702684*^9}, 3.847395256914475*^9},
 CellLabel->
  "(Local) In[44]:=",ExpressionUUID->"2c2d71a9-ec7f-4e1b-9d61-10f5ca3497bd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mags", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"magModified", "[", 
      RowBox[{"(", 
       RowBox[{"\"\<mag\>\"", "/.", "#5"}], ")"}], "]"}], "&"}], "@@@", 
    "imported"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListPointPlot3D", "[", 
   RowBox[{"mags", ",", 
    RowBox[{"BoxRatios", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "1", ",", " ", "1"}], "}"}]}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<minmax=\>\"", ",", 
   RowBox[{"{", 
    RowBox[{"minmaxx", ",", "minmaxy", ",", "minmaxz"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<bias=\>\"", ",", 
   RowBox[{"{", 
    RowBox[{"bx", ",", "by", ",", "bz"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<MT=\>\"", ",", "MT"}], "]"}]}], "Input",
 CellChangeTimes->{{3.846702990615094*^9, 3.846703073426008*^9}, {
   3.846703589933268*^9, 3.846703594971387*^9}, {3.8467049728256598`*^9, 
   3.846705106825262*^9}, 3.846705137168024*^9, {3.846705404910494*^9, 
   3.846705666025695*^9}, {3.846707687691687*^9, 3.846707699740457*^9}, {
   3.846708329412284*^9, 3.84670837550592*^9}, {3.847395256917109*^9, 
   3.847395298135112*^9}, {3.847395358347556*^9, 3.847395359380877*^9}, {
   3.847395413898879*^9, 3.847395428141563*^9}, {3.8473967849003363`*^9, 
   3.847396788196432*^9}},
 CellLabel->
  "(Local) In[45]:=",ExpressionUUID->"e6ac0be5-8608-4e25-b8c8-cf59ca014ad3"],

Cell[BoxData[
 Graphics3DBox[{
   {RGBColor[0.3315753, 0.4561011, 0.6388182], PointSize[
     NCache[
      Rational[1, 90], 0.011111111111111112`]], Point3DBox[CompressedData["
1:eJyFnA14ztX/x29D5Lmi30jMY5I8ReXx3OQpkUjyk8xTiZZEpcJ2mwg/yU9S
+GULyVOeac3aubFmWMzMxobdm5nNNnuexez+n+/3vl/HdX1dXf/r6rpcfa6z
c5/vOZ+H9+fzeZ/TYvKHo97xsdls2VVtNvWfLavso7CgJvli/M289u5DsXLV
W08tc2y8JhdVPBzuduaIgH1Vf3TX/VPLL3VtHy6y8kTvzZ17uJ2nZYOIQ7+I
MRly9TN5R+QHecLW6PAb7sSTcsX2EX/Z7Zl6fNSSXrPduSf+cTzyUzPTj7gP
5Qq/8XMGu0+fktsatEq11buu51lR7lzp9onW8zMP8uS8el/K8Ew59PeG4fKz
XP27jEduHW+dh/FZk+pGuNfk632Y3X/+EcfsG9Kv57QwOfmWuDh8ZIZ7gFNu
mfBKq6N7bsjQ/G7h7pBbwrUjcnvl7a3yYq8XYoLGZ+v1z1p5Mr2y1WbZsq7P
EvvDOXr8RXP8YT1e789OQ75WJizzr2OvzJGrnSPDRHGuli8ZGPrG0UU5cu6Z
8t/dO/L0PM3ean/KtjNPnqo6OCyoV66Iu7bthcqQ3VrOeqzzP/pp8/Cgznl6
fEBItiOozS29TmfnTZtrh64UAVdjX6pyOFf/7msnDsyqPB0uw1uuuKP+XqJX
MeY8kXoezpfx8UlfvWYLvSX9fvaJEFduCd8ePb6uTAuTSx/6Y7X6TrnnwPww
EZ+v9zm371uTnR/k6d/t3GrZ7+5Wx+XaiY8HOZrky3lDyq+mhhaI12YM2un2
jZI9j91LcX52fx7kzDO2fp2r/m0LtJ4g9y/sdCVIFmg9ZJ3oA/aCnPmXj76e
6F5zVlYrGRNmv3JL/tCtzRVZo0AE1G133R1yRrapVjrX9l3+A3LOxbqe0CNh
WUrPZK+wly67BxSIBHMf4iT7z/iNQTucQdvj9Xj2ATtlH6zzWNfPeOax7gP7
/N4uES7fvP+97JtVzu9iLwtfzDsTdPCcfHv/4nnON/O1nrP+3DemfmyPz9d2
GhE9bX/QxvPS72jW8NApBXqez7rsbOre8ZeMnP/T8xPbFmj9rH/59Al3x3i9
TvSN700+P/1FZ40C/bvJddtsCfo2QX8v+m+dB31Gzjn2+v6tcKXXomhNvUR3
j3N6fubBb+j1eO2R8b19942wDSyQVQf3DpOLcvT+8729SmOPBA3KEdtEoMN9
O1qurqusoOJBect9V/rY5xbq+Tkv5Phzq5x9xi6yHh071BVaoPcN/eR3q+5P
OiIqc7Sf/PTw8y9NfKJQr6fE/K6j8vSRb4Y4ZIE8Ity/i4dzxNI3Oo6uPBQh
+9bcKkLH3h+P/Wb7DO/pOHhfjn0hZx7W2bHg9IiJDYr0+hua53JMVh/XqLfr
u/vjsSPkvZZ3CXOfvqn9Et91JGHKYbnyph7Pd1njBb+7qP6p0KBpWfp7mWfw
D2PPutOy9L6N85/Zz9azUE7OanlWvHJdz888sy4sSaj0jdLy/W+Fv+iaXirr
eL+H+NgqLEVMzC+Rn1wZ+o49IF3q7/qo2asT7xTL1x+NSbGlZ0n0Lfnm7KH2
gCL57u5pU4xzsOrhirkprpDhRZLvwk6Hztw2J7R/sZ6/1tiHOjvXZcvHP897
1j6mRM+T+EWT/1TJuyEzxjeLdvuWyIy/yqe402LkRNNfuGTP/pN2+meU6vVP
HT66jWNksty9cu6moAVlknOvFjZkla31eTlzQufHQluUSfRkyMAvyqrknZDR
Tf0Tm/+vTK9nr//K49UHOuWS3H8NttvLJHFkryfuiYahVV7z+6VUoieXuxaO
XSDjRMeO2Yucf5ZKziuga8m6e6eTBd+F/HHbCHdljzTB/oQ2HRBdWfeQ/GJJ
o8fsYzJEk2r7ToQou7QNPex/LSRQ7tj3dEXkliwxskXdt4145ViwoX7j0EAx
+1rwxb5K/+qdj/xd4QvhvHkzO3B7vDhQd3VJ85gi0aHJ/J1yzw1RMDr9u6Cl
F8S/R0zpEjq8SKD/K8zfvSCeruP4xfC/xLsIcx+SxFnTnxUI/FhWp8fTFo6/
JB5a4jvaqfwjccph+uFU0TIv5x2H8kf4+aZNB9cIapIqjr3bZpRoeFMQLy7K
Cn9ZmCbGdfwqOHJdtjjywSNXRXCBiBz79KvuVtdEsnnOWYI4snR5cPugpdfF
o/8L+SpoQabA/8e/NTxLdL8hJp9r/IfMTBf4z8MlnycadnPK9A8uvf7Y2z/O
UvonAj5KGh+kvoN5zONT3xOwdvMjC9Q+sZ/5X1aNVucjysP+a1iecHRyOYU9
UyQ82flgalCxcLw+fJxPz30yzIwf10Tezn9lBW0sFg26R/9QvfUBef7ZXlEi
IF2EHx6/qfn+EvHZqGpXqjaOkqEfrNridqaI+AEDEmVcibi4rcOeKodj5VRT
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
U+EbvYXKN+oH/jDHwOX44dG/rl2szk9gRx89M2e7UR9N8OqRx//mihrftJms
9kuONfPPNLHVPdJu5BXTE2seMHAP+L+sW+wnRh5SNGlkgFFHwQ9jd0MHrxnp
LCyUX96e+4g6b4Hddf1915N+5wtlxJ/Nui9coFT6h3l5fZV++z7zZ3aQyteJ
L+D8c87Avmpf5MFJH/5R5WiKwN4X9bkcZdQLySNYJ3b6Wq1qrxh5Oev88PMN
ec49N+Tap28PU3hTRA2MPuhQ34GfAff2ruHaG6jW9dS4bTnqfGWPMWcWqTxZ
bNn8bHmgiuvsZ/z7Y8tDWpSJuN1dNt5WOIP8etB/x/2VqnDAZ546lsaBv86L
G6vyY4HfAA+TX2wx/V+csOLk3uY5XxAhXvuPSd88Q+X/olv6YxUKz4v3l7pm
Gvg1xvyefAHe+/enc183/EfmhI+C1Xw6joMz0XP0bXmb5d2r7LwisZfb+XuF
kb9Fv+mKs1VNlLPuTVys/KKO1/h/cDv545rS649XCz0j55s4p1DUerGgvu1o
jpavMddXrM8RfML+kP9WW7t11L01Z2WNnu4n/FTcIl+O/XL7XB+VB3Au5KHU
Pcjvkp9osc2oixEfW30RWdvWs1DjE+L7G2u/nmOfWyjAt35mnrVRnwv5L3iS
dS7/IbCjUd/p7Fm/mOdfpdC/erH+3ffNuvVVLR/3wYyB9vZZor3H33vz2yLx
qRlvM3Vez/joUwknI+MyBHXC70OcLuM8dmzK+MKh7HXUyaFXUpcXifCtI1er
fEKs7vXIdKf6N+zKrCi3T6Z4JuL5NOW35Gwzz8zz5uHnBXlKfxMX3BR2T14i
K85X3FBxWq6ueHZrX5V/T5jQJkrhIeny+FGZ3mVbSqDKh9Gf/kfn3XN3LJLY
KfY1bOvo80LlT+gndaSX90xKU/ap6y2zs4t3GX9P/HLcjSi+ELJRzGpQ86zK
w+WTX7+eavRX7BXta1U/HCGRrz98skhmpssGpl6dlhHhkTNU/injze9yyc4t
7b2rKH3d1CHpeaU3Gg+4Vv0UadgtdSrqwO0+2nfPyMfIQ4lH1IexL3Aj9boU
EzdlaL9X1q/XMIU/5dumfbjk7Oh+r6vfE8NeWNZvYvViiX/G70V+u2OIa3mR
RM/BvdTlbNWOFd++vVaAGzd7v6e1oyywMvGksJvxYa3+3cshmcKtcApxubPL
KZSdSfIUR5P9p6vE7tDr8fjLFN3HYR6PHaUL8H+1GX7D7MEFsp6nzyaoX1Hn
dJi4+JqgfkX9mXrLKjOv3qz388gf47ao/ERQH6P+36HL4j8MOwZv0J8q8foJ
+lM1t3b82IgHxGvqh70/vvC9Ebeo04KHN5m4L0diX+Ac5h+8cMQfRv3pWXP8
ed0fAUdZ5dSLyOOYhzptuWe/5ai5f3fpl5Un1689EO+ue128YuaDCbrPtdF/
TahU9s087Ntgc1zGA/0C6/zsJ+vZ+GtEhoGfmKfk/ZxfFE7Wv8s56u8dueGK
0mctZz3WecA/9WtdzXHfTtTr2fjpj/uNOl25V6+p/+vfNevZF++P/3prlFyX
LRqd2rdT6Z3WH8YzP30Q5F958PL9dXp/1/GuuyhoQaJe5zsxdfYYeI3f3Ts6
4nkDfzCefg37hn4iZx70ZIqJk+N0X4nx9KeYh9+l70CdHD2nTs487D/6ad0f
6gb0AcHt5Dv0+94x6wXZWv/RT/oI1j6pY1B2vFTxk3zKOj91bOanr8T30nej
H4ReWftT1nNk/HRvfRA5eYf1XJiH8fS5rPPTJ8I/oCf0i+vdPHFaNM/WeoK+
Ibf2DVkP9og+45fQB9bJPrP/7AP7THyhXsj50tfQ83v1DT1hn5kHOefFudOH
4nyZh/n/6XzZf/aB+fkuvpd5WD/7g3z31BODjLqq7vdZ+kSci7W/iV6xP8yD
nHPR/ucf9Ac+g9V+6QsQ99ln+o9Wv0GfjnNHH3R/2esP6T+yHque0wfEP1v9
J/bOeKs9Ei/we8Q79Jzz0jwE9NbrZ4ibnDu/i55Yz906D/pJH41zR3+s67fq
A7wL3ce06AP7Tz/Oqs/UtfA/1jhu9av0u7EXqxx7J44TT9lP4jJyvou6Cv4c
vAfOYX70Vsdrrz4Qp6zzW+MvdoH/J45rXoT3XIj7Vnthn63zML+VH/JP47FT
63hrfBlt4tycB/hXnDv2a+XJWHEa+Ac/w/da9Z/14M/5LvwA+tC+5+rTRv7P
d1nl1vPlHLF39tN6XugJ+Ro4EDl1OSt+Q38YT/wCP1v9DH1GxqNvVtzIPBqn
WXg7/6Q/Vh6ClVfDOSLHr+JPIh4b/LlRV2U8/iHS4+80/woeBXLyVvwP+oMc
/wBuYZ2sB1yNXrH+WQrO2xvefEBu9T/oG/qMP8TPoCf4B8Zjp5wLvBeN/y36
Q3whb7Lyc9ab55Su9Rn9mRzeYKcIdunzQg+Zx6qH2CP+kPVgR+yDlY9H3Mfu
kBNfyI+s4wvMOv1Nbb+c46Zdc6YtVPk6/pw8jnNBH/DznCPnDi7ld5mfcyG/
wy9Z8a32VxY8jP9Hf9B/zlefI/7E67et54Vd42+xa+RW/AZPwcpPO5S5IF7M
TdN4gPWgD9i79tuWvM+ad1vtHTn5LP4TPwBeZTx1Ic0D9O4D+YvV/7Nv7I/O
W735FPvA7yInPmKP2B2/y/la8ynihc53/p/4hVznj959Aw97++waX3Eu+FXN
d/LGBeIL+s/+E0fQQ8azn1Y5/sGKczgXzssa39Gff8pP2U/WQxxkHx6Yn7qK
Ny8gT8cekZOP6/2n7uGtD3BejB/p6W/oeTj32mbfyqX9D/0Rxus8yJK/oz/E
Tet3Ee+s38X+WPMs9kHzcvED3vnxM+gJ+mA9R+ToA/GCc8eP6TjinR//rHG7
107RQ423vd9FnMWfMB45eQfj+S7k6I8VzxO/rHxjrf9e+/r/9Bn/wLmgD9gj
eTdy8gjyJnCF1Q+wHuwO+8XPWPN07Ag/b+VdM7+17sE6rTxYax2G8ei/lR/L
eOTsD/bI7xJHOBdd57TYO+dFfGEe9I24wLngr5jf6uet9SUrb5l808rTxk9a
cbi1Xmr1J/gl7J35iXcaj4HbvfwW4j7nhZ8hvmPX5O/Mw7kzP3rF+aKfzKP1
0Ks/+H+rvnHu/K7G597vBXdhR8RNa31G+x9LXs/vcu7tTJ7ovgfqisgZj91x
H0Tn3d59sPoT9AG+B/aCvwW3c77MY603Ek8nmvdNDmj/ZrUvnc9a6o3oLXrC
d+n6klfOelg/cms9hPMCr2pc5N038g7yffAY/oG+xoDl408b/FTOK3bnly8a
fWjyO84Xv335bq2l7h1X7tuRlxd92fSPFzV+Qw5/DH2jjwO/izyuvEvn3vZJ
xdLXg0e1Hnr60CUSfhfxevy7AS/57S+R8HaoMzD+jNlXj5fof3bjMcNsjUsk
fBvsTi4KedGxsVj3p5JNnHVJ0leiX/xK9Ixi9d1y+sqRLzkziyR9vece+fBH
gycKH54+Nbwa+Oru9p/eNPQFOf4q+5Mv1hjxvMD0b2lar+CBw8MpN/lVxwU8
z0E/vXPF6LMFNJzxvWN7vJh6Yd5ig/+OnD4+fUb4cvAN4PNMqtkj3+DZ0B9/
bvDAUUeVndU2++zpmo996N87Oxh23+6lkEtS7RP9Zfrv4Jy+o+Vc5fc0//OY
l6eZOP3lXCPPgQfLPtB/h+/E/sPTaGv2ma9IcBE8q2iTh5Ik8XvwweBloW/w
yrxy7QeKp+b9nPpxidgl29gMPgJ9QPiN9IXLfzP49MfFO6YelYph7Zu8r/yv
iDH5ACc1n83LR9V8Hg9PolhgL/A94LOdf7zrfrVfms+ZsqdwhNHfJg/y8B5c
mt+ieVDePBi+AePhe8BXxH7hh9Pvtsrp4xe+nb9ZnasI/PhumVHH4nzJ1+CH
wGNn/fB56LO3N3kELlFgzlcg7mRu7mLgKub5LjrBR/kXzWNnHvgDQ5s2m2aM
m+HlrSNfY/KALotQE2ckav65x49cFB1LnvU1+OPww+GBw7ubWP5sqsFz7RC5
KsrgB8Mfhm8APxw9bPFT/LOu5UV6PH3tKTuqbzD4X8gf7nfvSXv3G5rvseq3
V84Z+go/p9LkH98SHYJ+rWI7fFliR/Cj6L/DI/KdZ7/pXJSj5bYfrxxSvycD
Jq9Osas4OcjjryU8Iu4RtJ8cMN/gjyKHpxRt8sHSJPwi+vLMTz+8ncdva37a
lurHGxr+m3438o41LkxyfVyi72tERV34zeBJJw7ZutHw68S1itfX+S5U+854
4hHj8WPI4bNVHi9MUueh7780OHz4u6rpMXJyxTe/GPEBnDnEtONTsuJm9Tvq
XCV4j3sHvqMu1Tb6+fiH0MdFUs16hx6Qw2OH/0B8Qc7vEtfgaXCfBVwEX519
Iz5qvrqX18A6Y3bWeOqeb5Rg/4l3Ht7bGS2nPuOpf9338+R33ONg/eCHOj9m
VQtUcTfnqVGvGfdi4f1i1/A3PPzzK/oeCnqLvO9D3z/nGJ+t/blVDv+/rScu
CPITeKfL5/XZblf2TByBFwq/Dp7P+dlj7hj8+97l6zvZA9JF/7CZ+QaOIZ7i
97gX8/6J412MepvHH2SKCSaP/7qW49/gBbHOZqn5k+wKD3L/iHtGyPE/zJN7
zO+OkWd8YZ5zmhg5saC5kd9zrwc/Br8OPiHzYO/wXuD1sf9+Jm/lkuYBsv/I
8Z89dpacNOqI8GTgE3K+8PxZD3EZXuLuRpfm9J107f53mXXMZD2/5gd6/QPj
OS/OHb4T6y9qG/eR4e+Z56cxX6027ltHfF/nEeWP9P6Dlwq89Q/4VH948Lbe
N84dPjNx7dPvxq0JVOe5eXD/R/q9cl1+eXHHTAOnMw/+Gb8KvxF+0cH+m5qo
fdJ62N6bX3n4WDe1Pq+MaTrLpzzRe08oR8tLzO+M03EQvuhSb/xmfvj8nT28
XXGzwct9ner3zn78zkMKH2oeLDxMeN3Ed3it8PGQw+/1xNH749FP5MTTgFZ7
fI19hP8ftmdCqMKXep4NJm4oEuD/mu1LajvjMjRfvZMH1wrOCzm/S9xhHuI+
5w6PfanJH0wVFytTW/YLdun7esyPHTE//EBwEfgKHMV9Cvj5dzxxXjhNP3tO
31Ng/1ubcfGcxlfkKd023ThiCz2j8Rg4kPs43AsINvHXOdHN5Jv+qfn/5Cnw
crn/Ql5TYOLGA6K2eR+sRN9zgVfGvRvuq4JLkds8+d4DcldRlEK+h7T8lVZN
p/vnlwj72j2nC0JWCut9B+5lEC/Yz/cSz46812OfsOJk+HXER8bzu9RF2R/X
nEON7p7eoeuo6Bv52nqTn+nS8wfsDW9u3D8LLhqTZvhjeK0V/31uQrWkk/oe
AXxR8riXzfwrTxKn4LsGe/CqxN49fuiCrpcxPnrt8W+Dv03Q44lT2Ptis86T
L3eY55Qp2q8KDFV+VtcvwLfwfi968hl9v5V5uF+Gn+TeGfcX/ve/nIGVSo/B
n8u/yixQ+F6CY7m/dmtL40z/tmq8bcMfC1S+sdxjR/K17In3jPuy8K6Rc9/t
NfMeQZjmozK/n3muW8Wtt9tVD25zVfNabbuPfxUTEija7q65uTLkqh5vs9k2
FCWtj0QO3xU5vOhzZl5ZJDubfNnDku8deemNPOWPtJzvhR/LvUK9P977fUOO
2+dXr/enXG3eJ7ikxztMnBAtuffEeOTwcteZPNgi6eExn5Hc12vnycck90/h
V0e1CchQfkfzZtEffpd5uF+Q78k7NP7knin7AO6D180+IOf+0a0jLctTFR7k
/ubY2oNzqrY+IA+b9w2LNe4l7hzy+E3ZeVIrt6HHUxcVfqbmE4zn/mnoIwHj
DZyInPuk8GDZH+Tcv2D+2OyfAoz7kMQ11sk9lEgv35f9f6/TqZZVO8VL8uLz
o0dkKr+gv2v9ez/tdg9wCfbNz7SXoxI/D353phx7tU7rzZI8FLnLHvdpofJf
xC/OEVxNfBmwb1ZeiMK/sTNWTw9U+AU5eg6egffbM6fxNYWD9b0/7j/CDye/
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
Iy7BL0JPmuXf+Si0Q6lI8NbH/w+ldGlh
     "]]}, {}, {}},
  Axes->True,
  AxesLabel->{None, None, None},
  BoxRatios->{1, 1, 1},
  DisplayFunction->Identity,
  FaceGrids->None,
  FaceGridsStyle->Automatic,
  ImageSize->{328.9231192730125, 372.8248081411726},
  ImageSizeRaw->Automatic,
  PlotRange->{{-1.4131163, 1.4131163}, {-1.3832092, 1.3832092}, Automatic},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.02]}, {0, 0}},
  Ticks->{Automatic, Automatic, Automatic},
  ViewPoint->{-0.1635604575114543, -1.6327872021993322`, 2.959265775335619},
  ViewVertical->{-0.07063035105074181, 0.4210771840049007, 
   0.9042706224471478}]], "Output",
 CellChangeTimes->{
  3.846707713078103*^9, {3.846707947150991*^9, 3.846707968666709*^9}, 
   3.846708071022348*^9, 3.846708221709283*^9, {3.8467083299285316`*^9, 
   3.846708361502348*^9}, {3.846708404733*^9, 3.846708490741878*^9}, 
   3.847394263013582*^9, 3.84739518442253*^9, {3.8473952824910183`*^9, 
   3.8473952934239388`*^9}, 3.847395360574163*^9, {3.847395408853901*^9, 
   3.847395429058683*^9}, 3.847396715083075*^9, {3.847396764454113*^9, 
   3.847396789440776*^9}, 3.8474029158706083`*^9, 3.849394488550475*^9},
 CellLabel->
  "(Local) Out[46]=",ExpressionUUID->"b510db3a-db6e-4cb3-a851-eb8aa654fd02"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"minmax=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.347717`"}], ",", "0.4785156`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.6430054`"}], ",", "2.123413`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.6280518`", ",", "3.304749`"}], "}"}]}], "}"}]}],
  SequenceForm[
  "minmax=", {{-2.347717, 0.4785156}, {-0.6430054, 2.123413}, {0.6280518, 
   3.304749}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.847395282499113*^9, 3.847395293428678*^9}, 
   3.8473953605788794`*^9, {3.8473954088601103`*^9, 3.847395429063656*^9}, 
   3.8473967150873537`*^9, {3.847396764458261*^9, 3.847396789445136*^9}, 
   3.8474029158760138`*^9, 3.849394488553743*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1a(Local) \
In[45]:=",ExpressionUUID->"a531a67b-d763-421e-9149-dc824859028f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"bias=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.9346007`"}], ",", "0.7402038000000002`", ",", 
     "1.9664004000000002`"}], "}"}]}],
  SequenceForm["bias=", {-0.9346007, 0.7402038000000002, 1.9664004000000002`}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.847395282499113*^9, 3.847395293428678*^9}, 
   3.8473953605788794`*^9, {3.8473954088601103`*^9, 3.847395429063656*^9}, 
   3.8473967150873537`*^9, {3.847396764458261*^9, 3.847396789445136*^9}, 
   3.8474029158760138`*^9, 3.8493944885551567`*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1a(Local) \
In[45]:=",ExpressionUUID->"3ce6894b-1ffd-4e66-a5c1-e36c5af997de"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"MT=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2.078896159675358`"}], ",", "0.6262943741422963`", ",", 
     RowBox[{"-", "5.373521993784059`"}], ",", "0.4310477150319294`", ",", 
     RowBox[{"-", "0.39208148119255143`"}], ",", "0.04529947934072423`", ",", 
     
     RowBox[{"-", "2.032016750172331`"}], ",", 
     RowBox[{"-", "0.07233458012035765`"}], ",", 
     RowBox[{"-", "3.9153934247274367`"}]}], "}"}]}],
  SequenceForm[
  "MT=", {-2.078896159675358, 0.6262943741422963, -5.373521993784059, 
   0.4310477150319294, -0.39208148119255143`, 
   0.04529947934072423, -2.032016750172331, -0.07233458012035765, \
-3.9153934247274367`}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.847395282499113*^9, 3.847395293428678*^9}, 
   3.8473953605788794`*^9, {3.8473954088601103`*^9, 3.847395429063656*^9}, 
   3.8473967150873537`*^9, {3.847396764458261*^9, 3.847396789445136*^9}, 
   3.8474029158760138`*^9, 3.849394488562408*^9},
 CellLabel->
  "\:8a55\:4fa1\:4e2d\:ff1a(Local) \
In[45]:=",ExpressionUUID->"f254c89c-e053-4b70-8ea3-72243bc71948"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1440, 2515},
WindowMargins->{{-1440, Automatic}, {-114, Automatic}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (2019\:5e745\:67083\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 719, 15, 73, "Input",ExpressionUUID->"2b31d735-e29d-444a-bcfd-3faee6e2a949"],
Cell[1280, 37, 2092, 59, 94, "Input",ExpressionUUID->"7d1664e3-978f-41ab-a8cf-f1b98e9e35df"],
Cell[3375, 98, 1343, 35, 94, "Input",ExpressionUUID->"4a6f2f88-03d3-4b90-89b0-e6501177e11e"],
Cell[4721, 135, 1059, 29, 94, "Input",ExpressionUUID->"a3a97246-1bf3-4b96-9c04-34417016abea"],
Cell[CellGroupData[{
Cell[5805, 168, 172, 3, 54, "Subsection",ExpressionUUID->"0b6f9ebe-534c-4608-b031-61b2437664cf"],
Cell[CellGroupData[{
Cell[6002, 175, 10509, 295, 905, "Input",ExpressionUUID->"ee485b31-8882-4c18-bb3c-122587fae2ba"],
Cell[CellGroupData[{
Cell[16536, 474, 1605, 24, 24, "Print",ExpressionUUID->"3ac7890e-e77c-4c14-a3b3-6e907f2a3d53"],
Cell[18144, 500, 2445, 40, 24, "Print",ExpressionUUID->"2f1fd9c5-6504-4263-87fc-10303c2b2067"],
Cell[20592, 542, 1653, 24, 24, "Print",ExpressionUUID->"c8d0496a-781a-4298-a5c2-c41e616ccfa5"],
Cell[22248, 568, 2442, 39, 24, "Print",ExpressionUUID->"f8728432-5a65-489b-8a21-012f2402e896"]
}, Open  ]],
Cell[24705, 610, 2721, 46, 34, "Output",ExpressionUUID->"eb45f529-ec91-43c5-89e6-84fe19259ec1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27463, 661, 8745, 232, 1018, "Input",ExpressionUUID->"32f93084-6793-4ff0-a65e-e313500183e6"],
Cell[36211, 895, 651, 12, 34, "Output",ExpressionUUID->"c43fda8d-5c72-43f1-a7a9-11b7878fa012"],
Cell[36865, 909, 653, 12, 34, "Output",ExpressionUUID->"2f13862f-b395-40ad-9a6c-977faed1c4c1"],
Cell[37521, 923, 632, 11, 34, "Output",ExpressionUUID->"01da4302-0eea-43c6-8725-089f2a4c8cbd"],
Cell[38156, 936, 596, 10, 34, "Output",ExpressionUUID->"42c4d9a7-f5cb-4e8b-a658-2191439a47b2"],
Cell[38755, 948, 588, 9, 34, "Output",ExpressionUUID->"368b0947-b39e-4be4-bce9-0e292aa4edc6"],
Cell[39346, 959, 588, 9, 34, "Output",ExpressionUUID->"6ba28095-24b4-4b32-92a3-34e4f1590a9d"],
Cell[39937, 970, 669, 12, 34, "Output",ExpressionUUID->"63e024fe-0efc-4ed7-a639-bc548f340d15"],
Cell[40609, 984, 669, 12, 34, "Output",ExpressionUUID->"36dcf3f1-20bc-4318-9de1-aee92c836cf1"],
Cell[41281, 998, 686, 13, 34, "Output",ExpressionUUID->"5fcde627-422a-456a-8f57-f61172fbf2e9"],
Cell[41970, 1013, 642, 11, 34, "Output",ExpressionUUID->"22034877-2bc1-4f64-9831-26b2681fabbd"],
Cell[42615, 1026, 802, 17, 34, "Output",ExpressionUUID->"f5a1bd6f-9c77-4247-98b2-fb52078f392c"],
Cell[43420, 1045, 802, 17, 34, "Output",ExpressionUUID->"9600eb8f-86a4-46b9-9f2b-80693c321ad0"],
Cell[44225, 1064, 804, 17, 34, "Output",ExpressionUUID->"68390b61-323e-413a-8c0a-43bf0a4de2ca"],
Cell[45032, 1083, 2547, 57, 77, "Output",ExpressionUUID->"fc6e2735-733d-42ba-a7e0-ac7bddb78e8c"],
Cell[47582, 1142, 821, 15, 34, "Output",ExpressionUUID->"320509bf-59bc-4498-8a4b-2baeb59f3778"],
Cell[48406, 1159, 961, 17, 34, "Output",ExpressionUUID->"48105135-7962-4e88-84a9-cfcf3798f5ba"]
}, Open  ]],
Cell[49382, 1179, 2728, 71, 178, "Input",ExpressionUUID->"2c2d71a9-ec7f-4e1b-9d61-10f5ca3497bd"],
Cell[CellGroupData[{
Cell[52135, 1254, 1536, 37, 136, "Input",ExpressionUUID->"e6ac0be5-8608-4e25-b8c8-cf59ca014ad3"],
Cell[53674, 1293, 15085, 257, 425, "Output",ExpressionUUID->"b510db3a-db6e-4cb3-a851-eb8aa654fd02"],
Cell[CellGroupData[{
Cell[68784, 1554, 924, 23, 24, "Print",ExpressionUUID->"a531a67b-d763-421e-9149-dc824859028f"],
Cell[69711, 1579, 713, 15, 24, "Print",ExpressionUUID->"3ce6894b-1ffd-4e66-a5c1-e36c5af997de"],
Cell[70427, 1596, 1137, 24, 24, "Print",ExpressionUUID->"f254c89c-e053-4b70-8ea3-72243bc71948"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

